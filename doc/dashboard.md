# CYFS-Gateway Dashboard 需求
## 旁路由模式的UI逻辑 （思考未来的智能网关应该长什么样？）
从内->外，关心的是：路由规则（比如家长控制），有哪些路由链路(这是一种资源）可以用，付费链路的计费情况
- 管理可用链路
   可以看到所有已知链路，通过链路详情页
- 管理Hostname TagDB：
- 管理 IP TagDB
- 管理IP->DNS DB，允许立刻测试当前一个IP对应的hostname.
   IP->DNS DB可以来自 订阅，可以来自DNS协议Probe
- 管理 "局域网host": 通过一个zone文件，设置任意dns请求的返回
  旁路由一般都会通过DHCP，设置自己为默认DNS
  也可以开启”拦截模式“
- 设置规则：用户用自然语言输入规则后，复制得到一个提示词，粘贴到ChatGPT中可得到最终的规则
  一条自然语言规则看起来是：”儿子的ipad在工作日的下午5点到7点可以上网，访问儿童友好的网站“ 
  管理已有的规则，可以看到 自然语言的描述 + 实际工作的process chain rule
- 查看本机的Ip table(构造提示词去问AI是什么功能)
- 基于Tunnel的设备暴露功能（设备外网可访问）
  场景: 用户内网的一台设备开了远程桌面，要能从外网连接

## 运维模式的UI核心逻辑 （思考未来的Service Gateway长什么样? )

从外->内，把请求分发到服务提供者
- 关心的是请求是如何转发到各个服务的(Server是主体)
- 看到stack object,关键参数，实时流量/process chain请求数，相关log
- 看到server object,关键参数，实时流量/process chain请求数，相关log
- sdk面板：可以构造一个真实req或fake req,立刻运行看相关的process chain处理路径()

## 整体UI框架

### 查看当前工作状态 面板

展示目前系统的工作状态（总流量曲线，总请求数实时分类曲线）
列出目前工作中的核心对象的

#### 配置文件管理
cyfs-gateway的配置文件本质上是一个通过include(支持remote url)合成的大json

- 查看当前配置文件（合并顺序很重要）
- 用立即模式修改配置文件，配置文件修改不会立刻生效，需要手工点生效并确认后才会生效
- 触发手工同步配置文件并生效

### 测试（SDK）面板

测试项目：根据配置自动构造+配置文件定义
测试项目通常是构造一个真实行为，判断这个行为是否成和性能
比如在智能网关里，会列出常见的测试网站，判断路由规则访问相关网站是否成功以及访问性能

#### 查看日志

- 直接展示raw log
- 查看按trace-id整合的日志
- 过滤：看关键字过滤

#### 查看连接

通过tunnel框架，查看“系统处理的tunnel/stream" 主要关注数量、带宽消耗
- 系统中维持的所有tunnel （这个量一般不大）
- 系统中维持的所有stream
    这个量比较大，所以需要过滤。
    如果是http stream,还可以支持更多的过滤条件


### 系统设置
- 查看版本信息
- 语言设置
- 颜色模式
- 是否启用系统托盘（对windows/osx有效）
- 设置当前UI模式（是 路由模式 ｜ 开发者模式 ｜ 运维模式）
- 查看许可证

#### 安全设置
- 127.0.0.1 的访问直接得到授权 （设置dashbaord端口，得到URL）
- 管理token
- 登录密码

#### 配置导入导出
- 导出有多种类型：完整导出，全部配置导出，用户配置导出，链路导出
   完整导出的结果，可以被一个不能上网的机器导入并生效（包含了所有sync到的db)
- 导入只有一个入口，导入后前确认造成的影响，确认后再执行